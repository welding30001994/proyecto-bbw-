<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Premium Connect | Galer√≠a de Fotos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #800020;
            --secondary: #5a0018;
            --accent: #ff4081;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --gray: #6c757d;
        }
        
        body {
            background-color: var(--dark);
            color: var(--light);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
        }
        
        /* BARRA DE LOGIN */
        .login-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(128, 0, 32, 0.9);
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .login-bar span {
            font-size: 0.9rem;
        }
        
        .btn-login {
            background: var(--accent);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(255, 64, 129, 0.4);
        }

        /* CONTENEDOR PRINCIPAL */
        .content-container {
            padding: 80px 20px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* SECCI√ìN DE SUBIDA */
        .upload-section {
            background: rgba(128, 0, 32, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px dashed var(--accent);
        }
        
        .file-upload {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            padding: 20px;
            cursor: pointer;
        }
        
        .file-upload i {
            font-size: 3rem;
            color: var(--accent);
        }
        
        #preview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 10px;
            display: none;
            margin: 15px auto;
        }
        
        .progress-container {
            width: 100%;
            background: rgba(255,255,255,0.1);
            border-radius: 50px;
            margin: 15px 0;
            overflow: hidden;
            display: none;
            height: 8px;
        }
        
        #progressBar {
            height: 100%;
            background: linear-gradient(to right, var(--accent), var(--primary));
            width: 0%;
            transition: width 0.3s;
        }
        
        .status {
            text-align: center;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            display: none;
        }
        
        .success {
            background: rgba(76, 201, 240, 0.2);
        }
        
        .error {
            background: rgba(247, 37, 133, 0.2);
        }
        
        /* GALER√çA DE IM√ÅGENES */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .gallery-item {
            background: rgba(102, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .gallery-item:hover {
            transform: scale(1.03);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .gallery-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
        }
        
        .gallery-info {
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* MODAL PARA IMAGEN EXPANDIDA */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            max-width: 90%;
            max-height: 90%;
        }
        
        .modal-img {
            max-width: 100%;
            max-height: 90vh;
            border-radius: 8px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.5);
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 30px;
            cursor: pointer;
        }
        
        /* RESPONSIVE */
        @media (max-width: 768px) {
            .gallery {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .gallery {
                grid-template-columns: 1fr;
            }
            
            .login-bar {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- BARRA DE LOGIN -->
    <div class="login-bar">
        <span>üíé Contenido exclusivo para miembros</span>
        <button class="btn-login" id="loginBtn">Iniciar sesi√≥n</button>
    </div>
    
    <!-- CONTENIDO PRINCIPAL -->
    <div class="content-container">
        <!-- SECCI√ìN DE SUBIDA -->
        <div class="upload-section">
            <div class="file-upload" id="dropArea">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>Arrastra tus fotos aqu√≠ o haz clic para seleccionar</p>
                <input type="file" id="fileInput" accept="image/*" style="display: none;">
            </div>
            
            <img id="preview" alt="Vista previa">
            
            <div class="progress-container" id="progressContainer">
                <div id="progressBar"></div>
            </div>
            
            <button id="uploadBtn" class="btn-login" style="display: none;">
                Subir Foto <i class="fas fa-upload"></i>
            </button>
            
            <div id="statusMessage" class="status"></div>
        </div>
        
        <!-- GALER√çA DE IM√ÅGENES -->
        <h2 style="margin: 20px 0 10px;">Tus Fotos</h2>
        <div class="gallery" id="gallery">
            <!-- Las im√°genes aparecer√°n aqu√≠ autom√°ticamente -->
        </div>
    </div>
    
    <!-- MODAL PARA IMAGEN EXPANDIDA -->
    <div class="modal" id="imageModal">
        <span class="close-modal">&times;</span>
        <div class="modal-content">
            <img class="modal-img" id="expandedImg" src="" alt="Imagen expandida">
        </div>
    </div>

    <script>
        // Configuraci√≥n de Cloudinary
        const cloudinaryConfig = {
            cloudName: 'dba9d8',
            apiKey: '528757166221984',
            uploadPreset: 'web_upload'
        };
        
        // Estado de la aplicaci√≥n
        const appState = {
            auth: {
                isAuthenticated: false,
                userType: 'guest'
            },
            images: JSON.parse(localStorage.getItem('user_photos')) || []
        };
        
        // Elementos del DOM
        const DOM = {
            // Autenticaci√≥n
            loginBtn: document.getElementById('loginBtn'),
            loginBar: document.querySelector('.login-bar'),
            
            // Subida de im√°genes
            fileInput: document.getElementById('fileInput'),
            dropArea: document.getElementById('dropArea'),
            uploadBtn: document.getElementById('uploadBtn'),
            preview: document.getElementById('preview'),
            progressContainer: document.getElementById('progressContainer'),
            progressBar: document.getElementById('progressBar'),
            statusMessage: document.getElementById('statusMessage'),
            
            // Galer√≠a
            gallery: document.getElementById('gallery'),
            
            // Modal
            imageModal: document.getElementById('imageModal'),
            expandedImg: document.getElementById('expandedImg'),
            closeModal: document.querySelector('.close-modal')
        };
        
        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', () => {
            renderGallery();
            setupEventListeners();
            checkAuth();
        });
        
        // Renderizar galer√≠a
        function renderGallery() {
            DOM.gallery.innerHTML = '';
            
            appState.images.forEach((img, index) => {
                const imgElement = document.createElement('div');
                imgElement.className = 'gallery-item';
                imgElement.innerHTML = `
                    <img src="${img.secure_url}" class="gallery-img" alt="Foto ${index + 1}">
                    <div class="gallery-info">
                        <span>${(img.bytes/1024).toFixed(1)} KB</span>
                    </div>
                `;
                
                // Evento para expandir imagen
                imgElement.addEventListener('click', () => {
                    DOM.expandedImg.src = img.secure_url;
                    DOM.imageModal.style.display = 'flex';
                });
                
                DOM.gallery.appendChild(imgElement);
            });
        }
        
        // Configurar event listeners
        function setupEventListeners() {
            // Autenticaci√≥n
            DOM.loginBtn.addEventListener('click', handleLogin);
            
            // Drag and drop
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(event => {
                DOM.dropArea.addEventListener(event, preventDefaults);
            });
            
            ['dragenter', 'dragover'].forEach(event => {
                DOM.dropArea.addEventListener(event, () => {
                    DOM.dropArea.style.backgroundColor = 'rgba(255, 64, 129, 0.1)';
                });
            });
            
            ['dragleave', 'drop'].forEach(event => {
                DOM.dropArea.addEventListener(event, () => {
                    DOM.dropArea.style.backgroundColor = '';
                });
            });
            
            DOM.dropArea.addEventListener('drop', handleDrop);
            DOM.dropArea.addEventListener('click', () => DOM.fileInput.click());
            DOM.fileInput.addEventListener('change', handleFileSelect);
            DOM.uploadBtn.addEventListener('click', uploadImage);
            
            // Modal
            DOM.closeModal.addEventListener('click', () => {
                DOM.imageModal.style.display = 'none';
            });
            
            DOM.imageModal.addEventListener('click', (e) => {
                if (e.target === DOM.imageModal) {
                    DOM.imageModal.style.display = 'none';
                }
            });
        }
        
        // Funciones de Cloudinary
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        function handleDrop(e) {
            const files = e.dataTransfer.files;
            if (files.length) {
                DOM.fileInput.files = files;
                handleFileSelect({ target: DOM.fileInput });
            }
        }
        
        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (file) {
                // Validar archivo
                if (!file.type.match('image.*')) {
                    showStatus('Solo se permiten im√°genes', 'error');
                    return;
                }
                
                if (file.size > 10 * 1024 * 1024) {
                    showStatus('La imagen es demasiado grande (m√°x. 10MB)', 'error');
                    return;
                }
                
                // Mostrar vista previa
                const reader = new FileReader();
                reader.onload = (event) => {
                    DOM.preview.src = event.target.result;
                    DOM.preview.style.display = 'block';
                    DOM.uploadBtn.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        }
        
        async function uploadImage() {
            const file = DOM.fileInput.files[0];
            if (!file) return;
            
            DOM.uploadBtn.disabled = true;
            DOM.uploadBtn.innerHTML = 'Subiendo... <i class="fas fa-spinner fa-spin"></i>';
            DOM.progressContainer.style.display = 'block';
            
            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', cloudinaryConfig.uploadPreset);
            formData.append('cloud_name', cloudinaryConfig.cloudName);
            formData.append('api_key', cloudinaryConfig.apiKey);
            
            try {
                const response = await fetch(`https://api.cloudinary.com/v1_1/${cloudinaryConfig.cloudName}/image/upload`, {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (!response.ok) throw new Error(data.error.message || 'Error al subir');
                
                showStatus('¬°Foto subida con √©xito!', 'success');
                
                // Guardar imagen y actualizar galer√≠a
                appState.images.push(data);
                localStorage.setItem('user_photos', JSON.stringify(appState.images));
                renderGallery();
                
                // Resetear formulario
                DOM.fileInput.value = '';
                DOM.preview.style.display = 'none';
                DOM.uploadBtn.style.display = 'none';
                DOM.progressContainer.style.display = 'none';
                
            } catch (error) {
                showStatus(`Error: ${error.message}`, 'error');
            } finally {
                DOM.uploadBtn.disabled = false;
                DOM.uploadBtn.innerHTML = 'Subir Foto <i class="fas fa-upload"></i>';
            }
        }
        
        function showStatus(message, type) {
            DOM.statusMessage.textContent = message;
            DOM.statusMessage.className = `status ${type}`;
            DOM.statusMessage.style.display = 'block';
            
            setTimeout(() => {
                DOM.statusMessage.style.display = 'none';
            }, 4000);
        }
        
        // Funciones de autenticaci√≥n
        function checkAuth() {
            // Simular autenticaci√≥n
            const token = localStorage.getItem('premiumConnectToken');
            if (token) {
                appState.auth = {
                    isAuthenticated: true,
                    userType: 'premium'
                };
                DOM.loginBar.style.display = 'none';
            }
        }
        
        function handleLogin() {
            const confirmLogin = confirm('¬øSimular inicio de sesi√≥n premium? (Demo)');
            if (confirmLogin) {
                localStorage.setItem('premiumConnectToken', 'fake_token_123');
                appState.auth.isAuthenticated = true;
                DOM.loginBar.style.display = 'none';
                alert('‚úÖ Ahora tienes acceso premium');
            }
        }
    </script>
</body>
</html>
